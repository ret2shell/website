import{w as R,c as $,e as r,k as e,j as i,m as u,t as l}from"./index-DHCM5LJk.js";import{a as B,h as I}from"./index-DzhbeeeD.js";import{m as _,d as S,l as V}from"./rpc-BomgkFEB.js";import{m as h,p as y,C as j,x as z}from"./captcha-MLuD9_Bd.js";import{p as A,T as D}from"./header-C2rgC6oY.js";import{a as k}from"./toast-Bmssr5_f.js";import{B as q}from"./button-CWvnh7OL.js";import{C as E}from"./card-D1oJOCbi.js";import{I as v}from"./input-Cs8V4IvD.js";import{D as P}from"./datetime-P2UEB0PT.js";import{c as Z}from"./Form-CGI4Segl.js";import{r as m}from"./required-C9pyDEac.js";import{s as L}from"./setValue-Bf_BOLWD.js";import"./spin-B3vkVWkZ.js";import"./use-environment-context-CrE27ks0.js";import"./popover-root-Bs3_F_Uf.js";import"./use-presence-context-C0VfJ-0L.js";import"./use-locale-context-Bwyb0cy2.js";function H(p){return o=>o&&!/^(([^<>()[\].,;:\s@"]+(\.[^<>()[\].,;:\s@"]+)*)|(".+"))@(([^<>()[\].,;:\s@"]+\.)+[^<>()[\].,;:\s@"]{2,})$/i.test(o)?p:""}var N=l('<h2 class="font-bold text-center">'),M=l('<div class="flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-4">'),W=l('<div class="flex-1 flex flex-col items-center md:justify-center p-3 md:p-6">'),G=l('<span class="icon-[fluent--wand-20-regular] w-5 h-5">'),J=l('<span class="icon-[fluent--person-20-regular] w-5 h-5">'),K=l('<span class="icon-[fluent--diversity-20-regular] w-5 h-5">'),O=l('<span class="icon-[fluent--mail-20-regular] w-5 h-5">'),Q=l('<span class="icon-[fluent--lock-20-regular] w-5 h-5">');function fe(){const p=R();if(B.token)return p("/",{replace:!0}),null;const[o,{Form:C,Field:s}]=Z(),[x,w]=$(!1),[T,F]=$(P.now().toMillis());let g;function b(d){w(!0),setTimeout(()=>{I(d).then(()=>{k({level:"success",description:e("account.register.success"),duration:5e3,img:z}),p("/",{replace:!0})}).catch(t=>{t.response.text().then(a=>{k({level:"error",description:a,duration:5e3})}),F(P.now().toMillis())}).finally(()=>{w(!1)})},500)}return[r(D,{get title(){return`${e("account.register.title")} - ${A.config.name||e("platform.name")}`}}),(()=>{var d=W();return i(d,r(E,{class:"w-full max-w-3xl",contentClass:"p-6 flex flex-col md:flex-row space-y-2 space-x-0 md:space-x-6 md:space-y-0",get children(){return r(C,{onSubmit:b,class:"md:w-0 flex-1 flex-shrink-0 flex flex-col space-y-2",get children(){return[(()=>{var t=N();return i(t,()=>e("account.register.title")),t})(),(()=>{var t=M();return i(t,r(s,{name:"nickname",get validate(){return[m(e("account.register.nicknameRequired")),h(2,e("account.register.nicknameMinLength")),_(32,e("account.register.nicknameMaxLength"))]},children:(a,c)=>r(v,u({get icon(){return G()},get placeholder(){return e("account.register.nicknamePlaceholder")},get title(){return e("account.register.nicknamePlaceholder")},autocomplete:"nickname"},c,{get value(){return a.value},get error(){return a.error},class:"flex-1",required:!0,onBlur:n=>{n.target.value&&S(n.target.value).then(f=>{L(o,"account",f)}).catch(()=>{})}}))}),null),i(t,r(s,{name:"account",get validate(){return[m(e("account.register.accountRequired")),h(4,e("account.register.accountMinLength")),_(32,e("account.register.accountMaxLength")),y(/^[0-9a-zA-Z_]*$/,e("account.register.accountPattern"))]},children:(a,c)=>r(v,u({get icon(){return J()},get placeholder(){return e("account.register.accountPlaceholder")},get title(){return e("account.register.accountPlaceholder")},autocomplete:"username"},c,{get value(){return a.value},get error(){return a.error},class:"flex-1",required:!0,ref(n){var f=g;typeof f=="function"?f(n):g=n},get extraBtn(){return r(q,{class:"!rounded-l-none",type:"button",onClick:()=>{g?.value&&V(g.value).then(n=>{L(o,"account",n)}).catch(()=>{})},get children(){return K()}})}}))}),null),t})(),r(s,{name:"email",get validate(){return[m(e("account.register.emailRequired")),H(e("account.register.emailInvalid"))]},children:(t,a)=>r(v,u({get icon(){return O()},get placeholder(){return e("account.register.emailPlaceholder")},get title(){return e("account.register.emailPlaceholder")},autocomplete:"email"},a,{get value(){return t.value},get error(){return t.error},class:"flex-1",required:!0}))}),(()=>{var t=M();return i(t,r(s,{name:"password",get validate(){return[m(e("account.register.passwordRequired")),h(8,e("account.register.passwordMinLength")),y(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[^]{8,40}$/,e("account.register.passwordTooWeak"))]},children:(a,c)=>r(v,u({get icon(){return Q()},get placeholder(){return e("account.register.passwordPlaceholder")},get title(){return e("account.register.passwordPlaceholder")},autocomplete:"password",type:"password"},c,{get value(){return a.value},get error(){return a.error},class:"flex-1",required:!0}))}),null),i(t,r(s,{name:"captcha_id",children:a=>r(s,{name:"captcha_answer",get validate(){return[m(e("captcha.required")),h(4,e("captcha.minLength"))]},children:(c,n)=>r(j,u(n,{captchaForm:o,class:"flex-1",get idFieldValue(){return a.value},get idFieldError(){return a.error},get answerFieldValue(){return c.value},get answerFieldError(){return c.error},get timestamp(){return T()}}))})}),null),t})(),r(q,{type:"submit",level:"primary",class:"!mt-4",get loading(){return x()},get disabled(){return x()},get children(){return e("account.register.title")}})]}})}})),d})()]}export{fe as default};
