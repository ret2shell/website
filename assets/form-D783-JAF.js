import{c as B,b as E,d as h,e as n,k as a,m as s,D as p,l as b,r as v,q as F,t as c}from"./index-DHCM5LJk.js";import{u as q,c as D}from"./bulletin-BB9hU5Qg.js";import{A as P}from"./article-DsbJ-ALU.js";import{a as A}from"./index-DzhbeeeD.js";import{a as C}from"./toast-Bmssr5_f.js";import{B as d}from"./button-CWvnh7OL.js";import{E as R}from"./editor-CCtxy95a.js";import{I as N}from"./input-Cs8V4IvD.js";import{D as _}from"./datetime-P2UEB0PT.js";import{c as I}from"./Form-CGI4Segl.js";import{s as w}from"./setValues-D24qEHVO.js";import{r as y}from"./required-C9pyDEac.js";import{s as S}from"./setValue-Bf_BOLWD.js";var M=c('<span class="icon-[fluent--megaphone-20-regular] w-5 h-5">'),T=c("<input type=number>"),$=c("<span>"),V=c("<input type=checkbox>");function Z(e){const[i,{Form:x,Field:u}]=I(),[f,g]=B(!1);E(()=>{e.editSource?h(()=>{w(i,{title:e.editSource?.title||"",content:e.editSource?.content||"",enable_comment:e.editSource?.enable_comment||!1,weight:e.editSource?.weight||3})}):h(()=>{w(i,{title:void 0,content:void 0,enable_comment:!0,weight:0})})});function k(l){g(!0),(e.editSource?q:D)({...l,id:e.editSource?.id||0,created_at:e.editSource?.created_at||_.now(),updated_at:e.editSource?.updated_at||_.now(),publisher_id:A.id||0,access_policy:P.Bulletin,draft:!1,published:!0,path:[]}).then(o=>e.onDone(o)).catch(o=>{o.response.text().then(t=>{C({level:"error",description:`${e.editSource?a("form.saveFailed"):a("form.createFailed")}: ${t}`,duration:5e3})})}).finally(()=>{g(!1)})}return n(x,{onSubmit:k,class:"flex flex-col space-y-2 self-center w-full max-w-5xl flex-1 p-3 lg:p-6",get children(){return[n(u,{name:"title",get validate(){return[y(a("bulletin.titleRequired"))]},children:(l,o)=>n(N,s({get icon(){return M()},get placeholder(){return a("bulletin.titlePlaceholder")},get title(){return a("bulletin.titlePlaceholder")}},o,{get value(){return l.value},get error(){return l.error},required:!0,get extraBtn(){return[n(u,{name:"weight",type:"number",children:(t,m)=>[(()=>{var r=T();return p(r,s(m,{name:"weight",get value(){return t.value},class:"hidden"}),!1,!1),r})(),n(d,{class:"!rounded-none",get title(){return a("bulletin.pinned")},type:"button",onClick:()=>{S(i,"weight",t.value?0:1)},get children(){var r=$();return b(()=>v(r,`w-5 h-5 icon-[fluent--pin-20-${(t.value||0)>0?"filled":"regular"}] ${(t.value||0)>0?"text-primary":""}`)),r}})]}),n(u,{name:"enable_comment",type:"boolean",children:(t,m)=>[(()=>{var r=V();return p(r,s(m,{name:"enable_comment",get checked(){return t.value},class:"hidden"}),!1,!1),r})(),n(d,{class:"!rounded-l-none",get title(){return a("bulletin.enableComment")},type:"button",onClick:()=>{S(i,"enable_comment",!t.value)},get children(){var r=$();return b(()=>v(r,`w-5 h-5 icon-[fluent--chat-20-${t.value?"filled":"regular"}] ${t.value?"text-primary":""}`)),r}})]})]}}))}),n(u,{name:"content",get validate(){return[y(a("bulletin.contentRequired"))]},children:l=>n(R,{form:i,lineNumbers:!0,class:"flex-1",lang:"markdown",placeholder:"MARKDOWN",get title(){return a("bulletin.contentPlaceholder")},name:"content",get value(){return l.value},get error(){return l.error}})}),n(d,{type:"submit",level:"primary",class:"!mt-4",get loading(){return f()},get disabled(){return f()},get children(){return F(()=>!!e.editSource)()?a("form.save"):a("form.create")}})]}})}export{Z as E};
