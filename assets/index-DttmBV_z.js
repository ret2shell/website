import{c as $,o as T,e as t,k as o,j as u,m as i,D as C,q as P,S,t as n}from"./index-D-4Ec2E9.js";import{b as I,u as F}from"./platform-B4gXhAik.js";import{L as M}from"./logo-animate-Dsq31Qvw.js";import{p,T as L,a as U}from"./header-C4_4FixI.js";import{a as d}from"./toast-RiaHQnvP.js";import{B as x}from"./button-jqW8_kUd.js";import{I as s}from"./input-C0wwSomq.js";import{c as B}from"./Form-DGUtLwyz.js";import{s as D}from"./setValues-CxCjsZ5S.js";import{s as V}from"./setValue-D3eDTJml.js";import"./index-CDuUghHV.js";import"./datetime-P2UEB0PT.js";import"./spin-Cv0qhUOt.js";import"./use-environment-context-C2cuRCHg.js";import"./popover-root-C7Ww2Kgi.js";import"./use-presence-context-DB1lc17V.js";import"./use-locale-context-Cw8uL8t2.js";var q=n('<div class="p-6 flex items-center justify-center">'),A=n('<div class="flex flex-row space-x-2">'),N=n('<div class="flex-1 flex flex-col items-center">'),R=n('<span class="icon-[fluent--flag-20-regular] w-5 h-5">'),z=n('<span class="icon-[fluent--phone-footer-arrow-down-20-regular] w-5 h-5">'),j=n('<span class="icon-[fluent--link-20-regular] w-5 h-5">'),E=n('<span class="icon-[fluent--subtitles-20-regular] w-5 h-5">'),G=n('<span class="icon-[fluent--record-20-regular] w-5 h-5">'),H=n('<span class="icon-[fluent--checkmark-circle-20-filled] w-5 h-5 text-primary">'),J=n("<span>"),K=n('<div class="flex flex-col justify-end"><input type=checkbox class=hidden>'),O=n('<span class="icon-[fluent--circle-20-regular] w-5 h-5">');function fe(){const[g,{Form:k,Field:a}]=B(),[h,v]=$(!1),[c,_]=$(null);function w(r){if(v(!0),!c()){d({level:"error",description:o("admin.platform.fetchNotReady"),duration:5e3});return}const e={...c(),server:{...c().server,name:r.name,footer_info:r.footer_info,footer_url:r.footer_url,subject_info:r.subject_info,subject_url:r.subject_url,record:r.record,hide_maker:r.hide_maker}};F(e).then(()=>{_(e),U({config:e.server}),d({level:"success",description:o("admin.platform.updateSuccess"),duration:5e3})}).catch(l=>{l.response.text().then(m=>{d({level:"error",description:`${o("admin.platform.updateFailed")}: ${m}`,duration:5e3})})}).finally(()=>v(!1))}return T(()=>{I().then(r=>{_(r),D(g,{name:r.server.name||void 0,footer_info:r.server.footer_info||void 0,footer_url:r.server.footer_url||void 0,subject_info:r.server.subject_info||void 0,subject_url:r.server.subject_url||void 0,record:r.server.record||void 0,hide_maker:r.server.hide_maker||!1})})}),[t(L,{get title(){return`${o("admin.edit.title")} - ${p.config.name||o("platform.name")}`}}),(()=>{var r=N();return u(r,t(k,{onSubmit:w,class:"w-full max-w-5xl p-3 lg:p-6 flex flex-col space-y-2",get children(){return[(()=>{var e=q();return u(e,t(M,{width:128,height:128})),e})(),t(a,{name:"name",children:(e,l)=>t(s,i({get icon(){return R()},get placeholder(){return o("platform.name")},get title(){return o("platform.form.nameTitle")}},l,{get value(){return e.value},get error(){return e.error}}))}),t(a,{name:"footer_info",children:(e,l)=>t(s,i({get icon(){return z()},get placeholder(){return o("platform.form.footerInfoPlaceholder")},get title(){return o("platform.form.footerInfoTitle")}},l,{get value(){return e.value},get error(){return e.error}}))}),t(a,{name:"footer_url",children:(e,l)=>t(s,i({get icon(){return j()},get placeholder(){return o("platform.form.footerUrlPlaceholder")},get title(){return o("platform.form.footerUrlTitle")}},l,{get value(){return e.value},get error(){return e.error}}))}),t(a,{name:"subject_info",children:(e,l)=>t(s,i({get icon(){return E()},get placeholder(){return o("platform.subject")},get title(){return o("platform.form.subjectInfoTitle")}},l,{get value(){return e.value},get error(){return e.error}}))}),t(a,{name:"subject_url",children:(e,l)=>t(s,i({get icon(){return j()},placeholder:"https://github.com/ret2shell",get title(){return o("platform.form.subjectUrlTitle")}},l,{get value(){return e.value},get error(){return e.error}}))}),(()=>{var e=A();return u(e,t(a,{name:"record",children:(l,m)=>t(s,i({class:"flex-1",get icon(){return G()},get placeholder(){return o("platform.form.recordPlaceholder")},get title(){return o("platform.form.recordTitle")}},m,{get value(){return l.value},get error(){return l.error}}))}),null),u(e,t(a,{name:"hide_maker",type:"boolean",children:(l,m)=>(()=>{var f=K(),y=f.firstChild;return C(y,i(m,{get checked(){return l.value}}),!1,!1),u(f,t(x,{type:"button",onClick:()=>V(g,"hide_maker",!l.value),get disabled(){return p.license?.level!=="enterprise"},get title(){return P(()=>p.license?.level!=="enterprise")()?o("platform.form.hideMakerDisabled"):void 0},get children(){return[t(S,{get when(){return l.value},get fallback(){return O()},get children(){return H()}}),(()=>{var b=J();return u(b,()=>o("platform.form.hideMaker")),b})()]}}),null),f})()}),null),e})(),t(x,{type:"submit",level:"primary",class:"!mt-4",get loading(){return h()},get disabled(){return!c()||h()},get children(){return o("form.save")}})]}})),r})()]}export{fe as default};
