import{s as V,c as p,b as j,d as P,l as $,e as d,m as B,q as g,k as s,t,j as b,i as x}from"./index-DHCM5LJk.js";import{I as M}from"./input-Cs8V4IvD.js";import{i as R,j as D}from"./index-DzhbeeeD.js";import{S as L}from"./spin-B3vkVWkZ.js";import{B as N}from"./button-CWvnh7OL.js";import{s as u}from"./setValue-Bf_BOLWD.js";function Y(e,l){return n=>n?.length&&n.length<e?l:""}function Z(e,l){return n=>n&&!e.test(n)?l:""}const aa="/assets/xdsec-mascot-happy-C-ROClJF.webp";var O=t("<span>NONE"),S=t('<img class="w-20 object-fill">'),A=t('<span class="inline-flex space-x-2 items-center">'),H=t("<span>"),I=t('<span class="icon-[fluent--checkmark-20-regular] w-5 h-5 text-success">'),J=t("<span>ReCaptcha V3"),q=t("<span>HCaptcha"),U=t("<input class=hidden name=captcha_id>"),W=t('<span class="icon-[fluent--bot-20-regular] w-5 h-5">');function ea(e){const[l,n]=V(e,["idFieldValue","answerFieldValue"]),[h,f]=p(null),[m,w]=p(!0),[_,v]=p(!1),[k,i]=p(!0);function F(){w(!0),R().then(a=>{f(a),a.validator==="pow"?y():a.validator==="none"&&u(e.captchaForm,"captcha_answer","0xDEADBEEF"),u(e.captchaForm,"captcha_id",a.id)}).catch(()=>{f(null),u(e.captchaForm,"captcha_id","")}).finally(()=>{w(!1),u(e.captchaForm,"captcha_answer","")})}j(()=>{e.timestamp&&P(F)});function E(){const a=h();if(a)switch(a.validator){case"none":return i(!1),O();case"image":return i(!0),(()=>{var r=S();return $(c=>{var o=`data:image/svg+xml;base64,${D(a.challenge)}`,C=s("captcha.reload");return o!==c.e&&x(r,"src",c.e=o),C!==c.t&&x(r,"alt",c.t=C),c},{e:void 0,t:void 0}),r})();case"pow":return i(!1),(()=>{var r=A();return b(r,(()=>{var c=g(()=>!!_());return()=>c()?[d(L,{width:20,height:20}),(()=>{var o=H();return b(o,()=>s("captcha.calculating")),o})()]:I()})()),r})();case"recaptcha_v3":return i(!1),J();case"h_captcha":return i(!1),q()}}function y(){v(!0);const a=new Worker(new URL("/assets/pow.worker-C15Jo6ND.js",import.meta.url),{type:"module"});a.postMessage({challenge:h()?.challenge}),a.onmessage=r=>{v(!1),u(e.captchaForm,"captcha_answer",r.data),a.terminate()}}return[(()=>{var a=U();return $(()=>a.value=l.idFieldValue),a})(),d(M,B({get icon(){return W()},get placeholder(){return s("captcha.placeholder")},get title(){return s("captcha.placeholder")},get value(){return l.answerFieldValue}},n,{get disabled(){return!k()},get error(){return e.idFieldError||e.answerFieldError},get extraBtn(){return d(N,{class:"!rounded-l-none",get loading(){return m()},onClick:F,get disabled(){return _()||m()},type:"button",get children(){return g(()=>!!m())()?s("captcha.loading"):g(()=>!!h())()?E():s("captcha.loadFailed")}})}}))]}export{ea as C,Y as m,Z as p,aa as x};
