import{i as s,t as a,w as G,x as V,c as _,e,k as r,j as l,m as C,v as N,M as $,S as f,q as O}from"./index-DHCM5LJk.js";import{a as R,f as U}from"./index-DzhbeeeD.js";import{g as W}from"./platform-CZMYCHFk.js";import{L as Z}from"./logo-animate-DwzBVVhL.js";import{x as b}from"./xdsec-mascot-crying-CYXT9wEg.js";import{m as k,p as J,C as K,x as F}from"./captcha-MLuD9_Bd.js";import{x as L}from"./xdsec-mascot-normal-B0zf2pzB.js";import{x as T}from"./xdsec-mascot-unsee-DC4zWBPN.js";import{p as Q,T as X}from"./header-C2rgC6oY.js";import{a as S}from"./toast-Bmssr5_f.js";import{B as Y}from"./button-CWvnh7OL.js";import{C as ee}from"./card-D1oJOCbi.js";import{D}from"./divider-D2gFZMAr.js";import{I as E}from"./input-Cs8V4IvD.js";import{L as w}from"./link-C85afmZZ.js";import{D as I}from"./datetime-P2UEB0PT.js";import{c as te}from"./Form-CGI4Segl.js";import{r as q}from"./required-C9pyDEac.js";import{s as re}from"./setValue-Bf_BOLWD.js";import"./spin-B3vkVWkZ.js";import"./use-environment-context-CrE27ks0.js";import"./popover-root-Bs3_F_Uf.js";import"./use-presence-context-C0VfJ-0L.js";import"./use-locale-context-Bwyb0cy2.js";import"./components-Dq7YmzrW.js";var ce=a('<svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 256 250"><path fill=currentColor d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46c6.397 1.185 8.746-2.777 8.746-6.158c0-3.052-.12-13.135-.174-23.83c-35.61 7.742-43.124-15.103-43.124-15.103c-5.823-14.795-14.213-18.73-14.213-18.73c-11.613-7.944.876-7.78.876-7.78c12.853.902 19.621 13.19 19.621 13.19c11.417 19.568 29.945 13.911 37.249 10.64c1.149-8.272 4.466-13.92 8.127-17.116c-28.431-3.236-58.318-14.212-58.318-63.258c0-13.975 5-25.394 13.188-34.358c-1.329-3.224-5.71-16.242 1.24-33.874c0 0 10.749-3.44 35.21 13.121c10.21-2.836 21.16-4.258 32.038-4.307c10.878.049 21.837 1.47 32.066 4.307c24.431-16.56 35.165-13.12 35.165-13.12c6.967 17.63 2.584 30.65 1.255 33.873c8.207 8.964 13.173 20.383 13.173 34.358c0 49.163-29.944 59.988-58.447 63.157c4.591 3.972 8.682 11.762 8.682 23.704c0 17.126-.148 30.91-.148 35.126c0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002C256 57.307 198.691 0 128.001 0m-80.06 182.34c-.282.636-1.283.827-2.194.39c-.929-.417-1.45-1.284-1.15-1.922c.276-.655 1.279-.838 2.205-.399c.93.418 1.46 1.293 1.139 1.931m6.296 5.618c-.61.566-1.804.303-2.614-.591c-.837-.892-.994-2.086-.375-2.66c.63-.566 1.787-.301 2.626.591c.838.903 1 2.088.363 2.66m4.32 7.188c-.785.545-2.067.034-2.86-1.104c-.784-1.138-.784-2.503.017-3.05c.795-.547 2.058-.055 2.861 1.075c.782 1.157.782 2.522-.019 3.08m7.304 8.325c-.701.774-2.196.566-3.29-.49c-1.119-1.032-1.43-2.496-.726-3.27c.71-.776 2.213-.558 3.315.49c1.11 1.03 1.45 2.505.701 3.27m9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033c-1.448-.439-2.395-1.613-2.103-2.626c.301-1.01 1.747-1.484 3.207-1.028c1.446.436 2.396 1.602 2.095 2.622m10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95c-1.53.034-2.769-.82-2.786-1.86c0-1.065 1.202-1.932 2.733-1.958c1.522-.03 2.768.818 2.768 1.868m10.555-.405c.182 1.03-.875 2.088-2.387 2.37c-1.485.271-2.861-.365-3.05-1.386c-.184-1.056.893-2.114 2.376-2.387c1.514-.263 2.868.356 3.061 1.403">');function le(u){const{width:d,height:h}={width:24,height:24,...u};return(()=>{var n=ce();return s(n,"width",d),s(n,"height",h),n})()}var ne=a('<svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 256 236"><path fill=#E24329 d="m128.075 236.075l47.104-144.97H80.97l47.104 144.97"></path><path fill=#FC6D26 d="M128.075 236.074L80.97 91.104H14.956l113.119 144.97"></path><path fill=#FCA326 d="M14.956 91.104L.642 135.16a9.752 9.752 0 0 0 3.542 10.903l123.891 90.012l-113.12-144.97"></path><path fill=#E24329 d="M14.956 91.105H80.97L52.601 3.79c-1.46-4.493-7.816-4.492-9.275 0z"></path><path fill=#FC6D26 d="m128.075 236.074l47.104-144.97h66.015l-113.12 144.97"></path><path fill=#FCA326 d="m241.194 91.104l14.314 44.056a9.752 9.752 0 0 1-3.543 10.903l-123.89 90.012l113.119-144.97"></path><path fill=#E24329 d="M241.194 91.105h-66.015l28.37-87.315c1.46-4.493 7.816-4.492 9.275 0z">');function ae(u){const{width:d,height:h}={width:24,height:24,...u};return(()=>{var n=ne();return s(n,"width",d),s(n,"height",h),n})()}var ie=a('<svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 256 262"><path fill=#4285F4 d="M255.878 133.451c0-10.734-.871-18.567-2.756-26.69H130.55v48.448h71.947c-1.45 12.04-9.283 30.172-26.69 42.356l-.244 1.622l38.755 30.023l2.685.268c24.659-22.774 38.875-56.282 38.875-96.027"></path><path fill=#34A853 d="M130.55 261.1c35.248 0 64.839-11.605 86.453-31.622l-41.196-31.913c-11.024 7.688-25.82 13.055-45.257 13.055c-34.523 0-63.824-22.773-74.269-54.25l-1.531.13l-40.298 31.187l-.527 1.465C35.393 231.798 79.49 261.1 130.55 261.1"></path><path fill=#FBBC05 d="M56.281 156.37c-2.756-8.123-4.351-16.827-4.351-25.82c0-8.994 1.595-17.697 4.206-25.82l-.073-1.73L15.26 71.312l-1.335.635C5.077 89.644 0 109.517 0 130.55s5.077 40.905 13.925 58.602l42.356-32.782"></path><path fill=#EB4335 d="M130.55 50.479c24.514 0 41.05 10.589 50.479 19.438l36.844-35.974C195.245 12.91 165.798 0 130.55 0C79.49 0 35.393 29.301 13.925 71.947l42.211 32.783c10.59-31.477 39.891-54.251 74.414-54.251">');function oe(u){const{width:d,height:h}={width:24,height:24,...u};return(()=>{var n=ie();return s(n,"width",d),s(n,"height",h),n})()}var se=a('<h2 class="font-bold text-center">'),y=a('<img class="w-36 h-36 hidden md:inline-block my-6"alt="Illustrated by hypnotics"title="Illustrated by hypnotics">'),M=a("<label>"),ue=a("<span>"),he=a('<div class="flex flex-row flex-wrap space-x-2 items-start w-full">'),de=a('<div class="md:w-0 flex-1 flex-shrink-0 flex flex-col items-center space-y-2"><div class="flex-1 flex flex-col items-center justify-center">'),pe=a('<div class="flex-1 flex flex-col items-center md:justify-center p-3 md:p-6">'),me=a('<span class="icon-[fluent--person-20-regular] w-5 h-5">'),ge=a('<span class="icon-[fluent--lock-20-regular] w-5 h-5">');function Ge(){const u=G(),d=V();if(R.token)return u("/",{replace:!0}),null;const[h,{Form:n,Field:v}]=te(),[p,H]=_({signing_key:"",buffer_time:0,expires_time:0,oauth_keys:null});W().then(m=>H(m)).catch(()=>{});const[x,g]=_(null),[A,B]=_(!1),[P,j]=_(I.now().toMillis());function z(m){B(!0),setTimeout(()=>{U(m).then(()=>{S({level:"success",description:r("account.login.success"),duration:5e3,img:F});const c=d.query.redirect;c?u(c,{replace:!0}):u("/",{replace:!0})}).catch(c=>{c.response.text().then(i=>{S({level:"error",description:i,duration:5e3})}),j(I.now().toMillis()),re(h,"password",""),setTimeout(()=>{g(b)},500)}).finally(()=>{B(!1)})},500)}return[e(X,{get title(){return`${r("account.login.title")} - ${Q.config.name||r("platform.name")}`}}),(()=>{var m=pe();return l(m,e(ee,{class:"w-full max-w-3xl",contentClass:"p-6 flex flex-col md:flex-row space-y-2 space-x-0 md:space-x-6 md:space-y-0",get children(){return[e(n,{onSubmit:z,class:"md:w-0 flex-1 flex-shrink-0 flex flex-col space-y-2",get children(){return[(()=>{var c=se();return l(c,()=>r("account.login.title")),c})(),e(v,{name:"account",get validate(){return[q(r("account.login.accountRequired")),k(4,r("account.login.accountMinLength"))]},children:(c,i)=>e(E,C({get icon(){return me()},get placeholder(){return r("account.login.accountPlaceholder")},get title(){return r("account.login.accountPlaceholder")},autocomplete:"username"},i,{get value(){return c.value},get error(){return c.error},required:!0,onFocusIn:()=>{g(L)},onFocusOut:()=>{g(null)}}))}),e(v,{name:"password",get validate(){return[q(r("account.login.passwordRequired")),k(8,r("account.login.passwordMinLength")),J(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[^]{8,40}$/,r("account.login.passwordTooWeak"))]},children:(c,i)=>e(E,C({get icon(){return ge()},type:"password",get placeholder(){return r("account.login.passwordPlaceholder")},get title(){return r("account.login.passwordPlaceholder")},autocomplete:"current-password"},i,{get value(){return c.value},get error(){return c.error},onFocusIn:()=>{g(T)},onFocusOut:()=>{g(null)}}))}),e(v,{name:"captcha_id",children:c=>e(v,{name:"captcha_answer",get validate(){return[q(r("captcha.required")),k(4,r("captcha.minLength"))]},children:(i,t)=>e(K,C(t,{captchaForm:h,get idFieldValue(){return c.value},get idFieldError(){return c.error},get answerFieldValue(){return i.value},get answerFieldError(){return i.error},get timestamp(){return P()}}))})}),e(Y,{type:"submit",level:"primary",class:"!mt-4",get loading(){return A()},get disabled(){return A()},get children(){return r("account.login.title")}})]}}),e(D,{class:"md:hidden"}),e(D,{class:"hidden md:inline-block",direction:"vertical"}),(()=>{var c=de(),i=c.firstChild;return l(i,e(N,{get fallback(){return e(Z,{class:"w-36 h-36 hidden md:inline-block my-6"})},get children(){return[e($,{get when(){return x()===L},get children(){return[(()=>{var t=y();return s(t,"src",L),t})(),(()=>{var t=M();return l(t,()=>r("account.login.accountMascotTip")),t})()]}}),e($,{get when(){return x()===T},get children(){return[(()=>{var t=y();return s(t,"src",T),t})(),(()=>{var t=M();return l(t,()=>r("account.login.passwordMascotTip")),t})()]}}),e($,{get when(){return x()===F},get children(){return[(()=>{var t=y();return s(t,"src",F),t})(),(()=>{var t=M();return l(t,()=>r("account.login.successMascotTip")),t})()]}}),e($,{get when(){return x()===b},get children(){return[(()=>{var t=y();return s(t,"src",b),t})(),(()=>{var t=M();return l(t,()=>r("account.login.failMascotTip")),t})()]}})]}})),l(c,e(w,{class:"w-full",href:"/account/register",get children(){return r("account.register.tips")}}),null),l(c,e(f,{get when(){return O(()=>p().oauth_keys!==null)()&&(p().oauth_keys?.length||0)>0},get children(){var t=he();return l(t,e(f,{get when(){return(p().oauth_keys||[]).find(o=>o.service==="xdu")},get children(){return e(w,{href:"/account/oauth?type=redirect&service=xdu",class:"flex-1",get children(){var o=ue();return l(o,()=>r("account.oauth.xdu.title")),o}})}}),null),l(t,e(f,{get when(){return(p().oauth_keys||[]).find(o=>o.service==="google")},get children(){return e(w,{href:"/account/oauth?type=redirect&service=google",square:!0,get children(){return e(oe,{width:24,height:24})}})}}),null),l(t,e(f,{get when(){return(p().oauth_keys||[]).find(o=>o.service==="github")},get children(){return e(w,{href:"/account/oauth?type=redirect&service=github",square:!0,get children(){return e(le,{width:24,height:24})}})}}),null),l(t,e(f,{get when(){return(p().oauth_keys||[]).find(o=>o.service==="gitlab")},get children(){return e(w,{href:"/account/oauth?type=redirect&service=gitlab",square:!0,get children(){return e(ae,{width:24,height:24})}})}}),null),t}}),null),c})()]}})),m})()]}export{Ge as default};
