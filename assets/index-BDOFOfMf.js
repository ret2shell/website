import{c as $,k as i,e as l,j as e,M as x,v as z,S as N,F as v,l as Y,r as Z,t as n}from"./index-DHCM5LJk.js";import{d as R,e as A}from"./index-DzhbeeeD.js";import{S as ee}from"./spin-B3vkVWkZ.js";import{p as te,T as le}from"./header-C2rgC6oY.js";import{a as re}from"./toast-Bmssr5_f.js";import{B as w}from"./button-CWvnh7OL.js";import{D as y}from"./divider-D2gFZMAr.js";import{L as O}from"./loading-tips-D8Ukv1g_.js";import{D as q}from"./datetime-P2UEB0PT.js";import"./loading-tips-CelvmSQ5.js";async function ne(){return await R.get(`${A}/cluster/config`).json()}async function se(){return await R.get(`${A}/cluster/nodes`).json()}var ae=n('<span class="icon-[meteocons--compass] w-full h-full">'),ie=n('<span class="icon-[meteocons--code-red-fill] w-full h-full">'),ce=n("<span class=text-info>"),oe=n("<span class=text-warning>"),de=n('<div class="h-20 lg:h-12 flex flex-row space-x-4 items-center px-4">'),ue=n('<div class="h-20 lg:h-12 flex flex-col lg:flex-row space-y-2 lg:space-y-0 lg:space-x-4 justify-center items-center px-3"><span class="lg:flex-1 opacity-60">Since <!>, <!> hours online</span><span class="flex flex-row items-center space-x-4"><span></span><span class="icon-[fluent--chevron-double-right-20-regular] w-5 h-5 opacity-60"></span><span class=text-warning>'),fe=n('<div class="flex flex-row flex-wrap py-2">'),pe=n('<span class="icon-[fluent--arrow-clockwise-20-regular] w-5 h-5">'),me=n('<span class="icon-[fluent--arrow-circle-up-20-regular] w-5 h-5">'),he=n('<span class="icon-[fluent--stop-20-regular] w-5 h-5">'),ge=n('<div class="h-12 flex flex-row items-center space-x-2 px-3"><span class="icon-[fluent--organization-20-regular] w-5 h-5"></span><span class="font-bold flex-1 text-start"></span><span class="opacity-60 hidden lg:inline"><span>Online at: </span><span>'),$e=n('<div class="p-3 lg:p-6 flex flex-col"><h3 class="text-center font-bold"></h3><table><tbody><tr class="border-b border-b-layer-content/10"><td class="font-bold opacity-60 p-2">Provider ID</td><td class=p-2></td></tr><tr class="border-b border-b-layer-content/10"><td class="font-bold opacity-60 p-2">Addresses</td><td class=p-2></td></tr><tr class="border-b border-b-layer-content/10"><td class="font-bold opacity-60 p-2">Pod CIDRs</td><td class=p-2>'),xe=n('<div class="flex flex-col"><h3 class="text-center font-bold"></h3><div class="flex flex-col xl:flex-row p-3 lg:p-6"><table class=flex-1><tbody></tbody></table><table class=flex-1><tbody>'),_e=n('<div class="flex-1 flex flex-col p-3 lg:p-6"><div class="h-32 lg:h-48 flex flex-row items-center"><div class="h-full aspect-square flex items-center justify-center"></div><h1 class="flex flex-col justify-center space-y-2"><span class="text-3xl lg:text-5xl font-bold">'),be=n("<span>"),ye=n('<div class="flex flex-col justify-center items-start min-w-fit"><span class=font-bold></span><span class=opacity-60>'),ve=n('<div class="flex-1 flex flex-col items-center justify-center space-y-8 opacity-60"><span class="icon-[fluent--organization-20-regular] w-24 h-24"></span><span>'),we=n('<tr class="border-b border-b-layer-content/10"><td class="font-bold opacity-60 p-2"></td><td class=p-2>'),Se=n('<tr class="border-b border-b-layer-content/10"><td class="font-bold opacity-60 p-2">Capacity </td><td class=p-2>'),Ce=n('<tr class="border-b border-b-layer-content/10"><td class="font-bold opacity-60 p-2">Allocatable </td><td class=p-2>');function qe(){const[S,j]=$(!1),[C,L]=$(!0),[I,B]=$(""),[H,P]=$(""),[E,G]=$(""),[J,K]=$([]);ne().then(o=>{j(!0);for(const u of o.items)u.data?.since&&B(u.data.since),u.data?.clusterDNS&&P(u.data.clusterDNS),u.data?.clusterDomain&&G(u.data.clusterDomain)}).catch(()=>{j(!1)}).finally(()=>{L(!1)}),se().then(o=>{K(o.items)}).catch(o=>{o.response.text().then(u=>{re({level:"error",description:`${i("admin.cluster.failedToFetchNodes")}: ${u}`,duration:5e3})})});const[c,Q]=$(null);return[l(le,{get title(){return`${i("admin.cluster.title")} - ${te.config.name||i("platform.name")}`}}),(()=>{var o=_e(),u=o.firstChild,T=u.firstChild,F=T.nextSibling,U=F.firstChild;return e(T,l(z,{get children(){return[l(x,{get when(){return C()},get children(){return l(ee,{width:24,height:24})}}),l(x,{get when(){return S()},get children(){return ae()}}),l(x,{when:!0,get children(){return ie()}})]}})),e(U,()=>i("admin.cluster.title")),e(F,l(z,{get children(){return[l(x,{get when(){return C()},get children(){return l(O,{})}}),l(x,{get when(){return S()},get children(){var t=ce();return e(t,()=>i("admin.cluster.available")),t}}),l(x,{when:!0,get children(){var t=oe();return e(t,()=>i("admin.cluster.unavailable")),t}})]}}),null),e(o,l(y,{}),null),e(o,l(N,{get when(){return C()},get children(){return[(()=>{var t=de();return e(t,l(O,{})),t})(),l(y,{})]}}),null),e(o,l(N,{get when(){return S()},get children(){return[(()=>{var t=ue(),r=t.firstChild,s=r.firstChild,a=s.nextSibling,d=a.nextSibling,h=d.nextSibling;h.nextSibling;var _=r.nextSibling,f=_.firstChild,g=f.nextSibling,p=g.nextSibling;return e(r,I,a),e(r,()=>q.fromFormat(I(),"yyyy-MM-dd").diffNow().negate().toFormat("hh"),h),e(f,E),e(p,H),t})(),l(y,{}),(()=>{var t=fe();return e(t,l(v,{get each(){return J()},children:r=>l(w,{class:"m-1 min-w-fit !h-auto py-2",get level(){return c()?.metadata.name===r.metadata.name?"primary":void 0},onClick:()=>Q(r),get children(){return[(()=>{var s=be();return Y(()=>Z(s,`${r.metadata.labels["node-role.kubernetes.io/master"]==="true"?"icon-[fluent--brain-circuit-20-regular]":"icon-[fluent--production-20-regular]"} w-8 h-8 ${c()?.metadata.name===r.metadata.name?"text-primary-content":"text-success"}`)),s})(),(()=>{var s=ye(),a=s.firstChild,d=a.nextSibling;return e(a,()=>r.metadata.name),e(d,()=>r.metadata.creationTimestamp),s})()]}})})),t})(),l(y,{}),l(N,{get when(){return c()},get fallback(){return(()=>{var t=ve(),r=t.firstChild,s=r.nextSibling;return e(s,()=>i("admin.cluster.selectNode")),t})()},get children(){return[(()=>{var t=ge(),r=t.firstChild,s=r.nextSibling,a=s.nextSibling,d=a.firstChild,h=d.nextSibling;return e(s,()=>c()?.metadata.name),e(h,()=>q.fromISO(c().metadata.creationTimestamp).toFormat("yyyy-MM-dd HH:mm:ss")),e(t,l(w,{size:"sm",square:!0,get title(){return i("admin.cluster.refreshNode")},get children(){return pe()}}),null),e(t,l(w,{size:"sm",square:!0,get title(){return i("admin.cluster.updateNode")},get children(){return me()}}),null),e(t,l(w,{size:"sm",square:!0,level:"error",get title(){return i("admin.cluster.disconnectNode")},get children(){return he()}}),null),t})(),l(y,{}),(()=>{var t=$e(),r=t.firstChild,s=r.nextSibling,a=s.firstChild,d=a.firstChild,h=d.firstChild,_=h.nextSibling,f=d.nextSibling,g=f.firstChild,p=g.nextSibling,m=f.nextSibling,b=m.firstChild,V=b.nextSibling;return e(r,()=>i("admin.cluster.nodeInfo")),e(a,l(v,{get each(){return Object.entries(c().status.nodeInfo)},children:([D,W])=>(()=>{var M=we(),k=M.firstChild,X=k.nextSibling;return e(k,()=>`${i(`admin.cluster.data.nodeInfo.${D}`)}`),e(X,W),M})()}),d),e(_,()=>c()?.spec.providerID),e(p,()=>c()?.status.addresses.map(D=>D.address).join(", ")),e(V,()=>c()?.spec.podCIDRs.join(", ")),t})(),(()=>{var t=xe(),r=t.firstChild,s=r.nextSibling,a=s.firstChild,d=a.firstChild,h=a.nextSibling,_=h.firstChild;return e(r,()=>i("admin.cluster.nodeResources")),e(d,l(v,{get each(){return Object.entries(c().status.capacity)},children:([f,g])=>(()=>{var p=Se(),m=p.firstChild;m.firstChild;var b=m.nextSibling;return e(m,f,null),e(b,g),p})()})),e(_,l(v,{get each(){return Object.entries(c().status.allocatable)},children:([f,g])=>(()=>{var p=Ce(),m=p.firstChild;m.firstChild;var b=m.nextSibling;return e(m,f,null),e(b,g),p})()})),t})()]}})]}}),null),o})()]}export{qe as default};
